<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="I use asp.net PageMethods in conjunction with ExtJS almost on a daily basis. PageMethods are simply server side methods that are callable from client side script. However, Microsoft assumes that you will be using PageMethods in conjunction with its Ajax framework, in particular the ScriptManager control which creates a JavaScript ...">
    <meta name="keywords" content="ajax,javascript,js,ExtJS">
    <meta name="author" content="Steve McArthur">
    <title>Calling ASP.net pagemethods from ExtJS | Steve McArthur</title>

    <!-- Twitter Card data -->
    <meta name="twitter:title" content="Calling ASP.net pagemethods from ExtJS | Steve McArthur">
    <meta name="twitter:description" content="I use asp.net PageMethods in conjunction with ExtJS almost on a daily basis. PageMethods are simply server side methods that are callable from client side script. However, Microsoft assumes that you w...">
    <meta name="twitter:image" content="https://www.stevemcarthur.co.uk/img/asp.net.jpg">

    <!-- Open Graph data -->
    <meta property="og:title" content="Calling ASP.net pagemethods from ExtJS | Steve McArthur">
    <meta property="og:url" content="https://www.stevemcarthur.co.uk/blog/post/calling-ASPnet-pagemethods-from-ExtJS">
    <meta property="og:image" content="https://www.stevemcarthur.co.uk/img/asp.net.jpg">
    <meta property="og:description" content="I use asp.net PageMethods in conjunction with ExtJS almost on a daily basis. PageMethods are simply server side methods that are callable from client side script. However, Microsoft assumes that you will be using PageMethods in conjunction with its Ajax framework, in particular the ScriptManager control which creates a JavaScript ...">

    <!--icons-->
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="manifest" href="/icons/manifest.json">
    <meta name="msapplication-TileColor" content="#fff">
    <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
    <meta name="theme-color" content="#fff">
    
    <link href="https://fonts.googleapis.com/css?family&#x3D;Poppins:400,400i,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family&#x3D;Audiowide" rel="stylesheet">
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
    <link href="/font-awesome/css/all.css" rel="stylesheet">


</head>
          <body>  <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Steve McArthur</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
                      <li class="nav-item">
                  <a class="nav-link" href="/">Home          <hr>
          </a>
          
        </li>
                       <li class="nav-item">
                  <a class="nav-link" href="/about">About          <hr>
          </a>
          
        </li>
                       <li class="nav-item">
                  <a class="nav-link" href="/blog">Blog          <hr>
          </a>
          
        </li>
                       <li class="nav-item">
                  <a class="nav-link" href="/contact">Contact          <hr>
          </a>
          
        </li>
              <li class="nav-item sc">
          <a class="nav-link"  href="https://twitter.com/stevemcarthur" title="Go to my Twitter account" aria-label="Go to my Twitter account">
            <i class="fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item sc">
          <a class="nav-link" href="https://github.com/SteveMcArthur" title="Go to my Github account" aria-label="Go to my Twitter account">
            <i class="fab fa-github"></i>
          </a>
        </li>
        <li class="nav-item sc">
          <a class="nav-link" href="https://stevemcarthur.slack.com" title="Visit me on Slack" aria-label="Visit me on Slack">
            <i class="fab fa-slack"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>  <div class="page-content">
    <header class="page-header">
     <div class="container">
        <div class="row">
            <div class="col-12">
                                    <div class="post-heading">
                                    
                        <h1>Calling ASP.net pagemethods from ExtJS</h1>
                                                                        <ul class="post-meta list-inline">
					        <li class="list-inline-item"><span class="byline"><span class="author vcard"><i class="fa fa-user"></i><span class="screen-reader-text">Written by </span>Steve McArthur</span></span></li>
                                                        <li class="list-inline-item"><span class="byline"><i class="far fa-clock"></i>March 19, 2010</span>
                                                        <li class="list-inline-item"><span class="cat-links"><a href="#" rel="category tag">javascript</a></span></li>
				        </ul>
                                            </div>
      
            </div> 
        </div> 
    </div> 
</header>    <!-- Post Content -->
  <article class="post">
      <div class="container">
          <div class="row">
            <div class="col-12">
            <div class="post-img">
                <img class="img-fluid" src="/img/asp.net.jpg" alt="Asp.net">
            </div>
            <div class="post-holder">
              <div class="post-content blog-post">
                  <p>I use asp.net PageMethods in conjunction with ExtJS almost on a daily basis. PageMethods are simply server side methods that are callable from client side script. However, Microsoft assumes that you will be using PageMethods in conjunction with its Ajax framework, in particular the ScriptManager control which creates a JavaScript proxy on the client side for the server side PageMethods. If you are using a JavaScript framework like ExtJS then you probably don&#39;t want to include the unnecessary clutter and page weight of the MS Ajax framework. Luckily PageMethods are callable like any other Ajax call. The trick is that it is expecting the name of the method as a forward slash parameter after the page name and the methods parameters as jsonData in the postdata. In ExtJS this translates as something like this:</p>
<pre data-type="code" class="js">Ext.Ajax.request({
    url: 'Default.aspx/myMethod',
    method: 'POST',
    success: onReturn,
    failure: onFailure,
    jsonData: '{Param1:"MyString",Param2: 1}',
        headers: {
            'Content-Type': 'application/json; charset=utf-8'
        }
     });
</pre>

<p>Note the headers property. This is the final piece in the puzzle. If you forget this then asp.net will think you are asking for the page and return the page itself instead of calling the PageMethod and returning the result of the method call as a json object. A couple of other &#39;gotchas&#39; to watch out for is to make sure your web.config file has the configurations in it to allow PageMethods to be called from client script. Normally this is done for you when you create an Ajax enabled application, but if you&#39;re converting from a non-Ajax application it boils down to entries in the httpHandlers and httpModules sections. httpHandlers:</p>
<pre data-type="code" class="js">     
<remove verb="*" path="*.asmx"><add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral,PublicKeyToken=31BF3856AD364E35"></add></remove>
</pre>

<p>httpModules:</p>
<pre data-type="code" class="js">     
<add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"></add> 
</pre>

<p>The last gotcha is a difference between how the json data is returned from a .net 3.5 application and a 2.0 application. In 3.5 the data is returned as a property called &quot;d&quot; of an otherwise empty json object. Whereas in version 2 the returned data was simply the result of the method call in json format.</p>
              </div>
              </div>
            </div>
          </div>
                    <!-- Comments -->
          <div class="row">
              <div class="col-12">
                  <div id="comments" class="clearfix">
                      <div id="disqus_thread"></div>
    <script>
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'stevemcarthur'; // required: replace example with your forum shortname
      var disqus_identifier = 'calling-ASPnet-pagemethods-from-ExtJS';
      var disqus_title = 'Calling ASP.net pagemethods from ExtJS';
      var disqus_url = 'https://www.stevemcarthur.co.uk/blog/post/calling-ASPnet-pagemethods-from-ExtJS';


      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();

    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    



                  </div>
              </div>
          </div>
          <!-- #comments end -->
                </div>
  </article>  </div>
  <!-- Footer -->
<footer class="py-3 bg-dark navbar-dark fixed-bottom">
    <div class="container text-center">
        <div class="row">
            <div class="col-12 mx-auto">
                <a class="navbar-brand" href="/">Steve McArthur</a>
                <div class="share2">
                    <div class="share-cont">
    <div class="socials">
        <a class="facebook" href="javascript:void(0)"  
            onClick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS', 'facebook-share', 'width=580,height=296');return false;"
            title="Share on Facebook" aria-label="Share on Facebook" >
        <i class="fab fa-facebook-f"></i>
        </a>
        <a class="twitter" href="javascript:void(0)"  
            onClick="window.open('https://twitter.com/intent/tweet?text=I%20use%20asp.net%20PageMethods%20in%20conjunction%20with%20ExtJS%20almost%20on%20a%20daily%20basis.%20PageMethods%20are%20simply%20server%20side%20methods%20that%20are%20callable%20from%20client%20side%20script.%20However%2C%20Microsoft%20assumes%20that%20you%20will%20be%20using%20PageMethods%20in%20conjunction%20with%20its%20Ajax%20framework%2C%20in%20particular%20the%20ScriptManager%20control%20which%20creates%20a%20JavaScript%20...&#38;url=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS', 'twitter-share', 'width=550,height=235');return false;" 
            title="Share on Twitter" target="_blank" aria-label="Share on Twitter">
        <i class="fab fa-twitter"></i>
        </a>
        <a class="google-plus" href="javascript:void(0)"  
            onClick="window.open('https://plus.google.com/share?url=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS', 'google-plus-share', 'width=490,height=530');return false;"
            title="Share on Google+" target="_blank" aria-label="Share on Google+">
        <i class="fab fa-google"></i>
        </a>
        <a class="pinterest" href="javascript:void(0)"  
            onClick="window.open('https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS&#38;media=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fimg%2Fasp.net.jpg', 'pinterest-share', 'width=490,height=530');return false;"
            title="Share on Pinterest" target="_blank" aria-label="Share on Pinterest">
        <i class="fab fa-pinterest"></i>
        </a>
    </div>
</div>                                   </div>
                <div class="m-0 sm">
                <span class="copyright">Copyright &copy; Steve McArthur 2019</span><span> <a class="tc" href="/terms-and-conditions/">Terms and Conditions</a> </span><span><a href="/privacy-policy/">Privacy</a></span>             
                </div>

                   
            </div>
        </div>
    </div>
    <!-- /.container -->
</footer>  <div class="sidebar container">
  <div class="share-cont">
    <div class="socials">
        <a class="facebook" href="javascript:void(0)"  
            onClick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS', 'facebook-share', 'width=580,height=296');return false;"
            title="Share on Facebook" aria-label="Share on Facebook" >
        <i class="fab fa-facebook-f"></i>
        </a>
        <a class="twitter" href="javascript:void(0)"  
            onClick="window.open('https://twitter.com/intent/tweet?text=I%20use%20asp.net%20PageMethods%20in%20conjunction%20with%20ExtJS%20almost%20on%20a%20daily%20basis.%20PageMethods%20are%20simply%20server%20side%20methods%20that%20are%20callable%20from%20client%20side%20script.%20However%2C%20Microsoft%20assumes%20that%20you%20will%20be%20using%20PageMethods%20in%20conjunction%20with%20its%20Ajax%20framework%2C%20in%20particular%20the%20ScriptManager%20control%20which%20creates%20a%20JavaScript%20...&#38;url=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS', 'twitter-share', 'width=550,height=235');return false;" 
            title="Share on Twitter" target="_blank" aria-label="Share on Twitter">
        <i class="fab fa-twitter"></i>
        </a>
        <a class="google-plus" href="javascript:void(0)"  
            onClick="window.open('https://plus.google.com/share?url=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS', 'google-plus-share', 'width=490,height=530');return false;"
            title="Share on Google+" target="_blank" aria-label="Share on Google+">
        <i class="fab fa-google"></i>
        </a>
        <a class="pinterest" href="javascript:void(0)"  
            onClick="window.open('https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fblog%2Fpost%2Fcalling-ASPnet-pagemethods-from-ExtJS&#38;media=https%3A%2F%2Fwww.stevemcarthur.co.uk%2Fimg%2Fasp.net.jpg', 'pinterest-share', 'width=490,height=530');return false;"
            title="Share on Pinterest" target="_blank" aria-label="Share on Pinterest">
        <i class="fab fa-pinterest"></i>
        </a>
    </div>
</div>                    </div>
  <a id="back-to-top" href="#" class="">
    <span>
      <i class="fa fa-angle-up "></i>
    </span>
  </a>

  <!-- Bootstrap core JavaScript -->
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.bundle.min.js"></script>
  <script src="/js/scripts.js"></script>
  
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function(){
            window.cookieconsent.initialise({
                "palette": {
                    "popup": {
                    "background": "#32949D"
                    },
                    "button": {
                    "background": "#65c7d0"
                    }
                },
                "content": {
                    "href": "/privacy-policy/"
                }
            });
        });
    </script>  </body>

</html>


